{"version":3,"sources":["utils/token.js"],"names":["saveToken","getToken","bearerToken","clearToken","ensureToken","ctx","token","maxAge","cookies","set","signed","httpOnly","get","next","redirect"],"mappings":";;;;;QAIgBA,S,GAAAA,S;QASAC,Q,GAAAA,Q;QAMAC,W,GAAAA,W;QAIAC,U,GAAAA,U;QAOAC,W,GAAAA,W;AA9BhB;;;;AAIO,SAASJ,SAAT,CAAmBK,GAAnB,EAAwBC,KAAxB,EAA+B;AAClC,QAAMC,SAAS,IAAI,EAAJ,GAAS,EAAT,GAAc,EAAd,GAAmB,IAAlC;AACAF,QAAIG,OAAJ,CAAYC,GAAZ,CAAgB,OAAhB,EAAwBH,KAAxB,EAA+B;AAC3BI,gBAAQ,IADmB;AAE3BC,kBAAU,IAFiB;AAG3BJ,gBAAQA;AAHmB,KAA/B;AAKH;;AAEM,SAASN,QAAT,CAAkBI,GAAlB,EAAuB;AAC1B,WAAOA,IAAIG,OAAJ,CAAYI,GAAZ,CAAgB,OAAhB,EAAyB;AAC5BF,gBAAQ;AADoB,KAAzB,CAAP;AAGH;;AAEM,SAASR,WAAT,CAAqBI,KAArB,EAA4B;AAC/B,WAAO,YAAYA,KAAnB;AACH;;AAEM,SAASH,UAAT,CAAoBE,GAApB,EAAyB;AAC5BA,QAAIG,OAAJ,CAAYC,GAAZ,CAAgB,OAAhB,EAAwB,IAAxB,EAA8B;AAC1BC,gBAAQ,IADkB;AAE1BC,kBAAU;AAFgB,KAA9B;AAIH;;AAEM,SAASP,WAAT,CAAqBC,GAArB,EAA0BQ,IAA1B,EAAgC;AACnC,QAAMP,QAAQL,SAASI,GAAT,CAAd;AACA,QAAI,CAACC,KAAL,EAAY;AACRD,YAAIS,QAAJ,CAAa,QAAb;AACA;AACH;AACD,WAAOD,MAAP;AACH","file":"utils/token.js","sourcesContent":["/**\n * Created by Bell on 16/8/16.\n */\n\nexport function saveToken(ctx, token) {\n    const maxAge = 7 * 24 * 60 * 60 * 1000;\n    ctx.cookies.set('token',token, {\n        signed: true,\n        httpOnly: true,\n        maxAge: maxAge\n    });\n}\n\nexport function getToken(ctx) {\n    return ctx.cookies.get('token', {\n        signed: true\n    });\n}\n\nexport function bearerToken(token) {\n    return 'Bearer ' + token;\n}\n\nexport function clearToken(ctx) {\n    ctx.cookies.set('token',null, {\n        signed: true,\n        httpOnly: true\n    });\n}\n\nexport function ensureToken(ctx, next) {\n    const token = getToken(ctx);\n    if (!token) {\n        ctx.redirect('/login');\n        return;\n    }\n    return next();\n}\n"],"sourceRoot":"/source/"}