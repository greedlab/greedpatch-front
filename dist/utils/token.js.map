{"version":3,"sources":["utils/token.js"],"names":["bearerTokenFromToken","bearerToken","ensureToken","cookie","token","ctx","getToken","next","redirect"],"mappings":";;;;;QAMgBA,oB,GAAAA,oB;QAIAC,W,GAAAA,W;QAQAC,W,GAAAA,W;;AAdhB;;IAAYC,M;;;;AAEL,SAASH,oBAAT,CAA8BI,KAA9B,EAAqC;AACxC,WAAO,YAAYA,KAAnB;AACH,C,CARD;;;;AAUO,SAASH,WAAT,CAAqBI,GAArB,EAA0B;AAC7B,QAAMD,QAAQD,OAAOG,QAAP,CAAgBD,GAAhB,CAAd;AACA,QAAID,KAAJ,EAAW;AACP,eAAOJ,qBAAqBI,KAArB,CAAP;AACH;AACD,WAAO,IAAP;AACH;;AAEM,SAASF,WAAT,CAAqBG,GAArB,EAA0BE,IAA1B,EAAgC;AACnC,QAAMH,QAAQD,OAAOG,QAAP,CAAgBD,GAAhB,CAAd;AACA,QAAI,CAACD,KAAL,EAAY;AACRC,YAAIG,QAAJ,CAAa,QAAb;AACH;AACD,QAAID,IAAJ,EAAU;AACN,eAAOA,MAAP;AACH;AACJ","file":"utils/token.js","sourcesContent":["/**\n * Created by Bell on 16/8/16.\n */\n\nimport * as cookie from './cookie';\n\nexport function bearerTokenFromToken(token) {\n    return 'Bearer ' + token;\n}\n\nexport function bearerToken(ctx) {\n    const token = cookie.getToken(ctx);\n    if (token) {\n        return bearerTokenFromToken(token);\n    }\n    return null;\n}\n\nexport function ensureToken(ctx, next) {\n    const token = cookie.getToken(ctx);\n    if (!token) {\n        ctx.redirect('/login');\n    }\n    if (next) {\n        return next();\n    }\n}\n"],"sourceRoot":"/source/"}